# なぜ bincode をシリアライズフォーマットに選ぶのか

このドキュメントでは、セーブ/ロードのバイナリフォーマットとして bincode を採用した技術的根拠を説明します。serde と組み合わせてゲーム状態を永続化します。

---

## 目次

1. [bincode とは](#1-bincode-とは)
2. [採用理由](#2-採用理由)
3. [本プロジェクトでの利用](#3-本プロジェクトでの利用)
4. [関連ドキュメント](#4-関連ドキュメント)

---

## 1. bincode とは

bincode は、serde 互換のコンパクトなバイナリシリアライズフォーマットです。

- **バージョン**: bincode 1.3（Cargo.toml）
- **役割**: ゲーム状態をバイト列に変換してファイルに保存
- **用途**: セーブ/ロード（saves/session.dat 等）

---

## 2. 採用理由

### 2.1 コンパクト

バイナリ形式のため、JSON よりファイルサイズが小さいです。ゲーム状態が大きくなってもセーブデータの肥大化を抑えられます。

### 2.2 serde との相性

serde の `Serialize` / `Deserialize` をそのまま利用できます。`bincode::serialize` / `bincode::deserialize` で簡単に変換できます。

### 2.3 デコードが速い

バイナリ形式はパースが不要で、デコードが高速です。ロード時の体感遅延を抑えられます。

### 2.4 バージョン互換の制御

フォーマットバージョンを自前で管理すれば、スキーマ変更時のマイグレーションも可能です。現状は単純な構造で十分です。

---

## 3. 本プロジェクトでの利用

- **用途**: セーブスナップショット（プレイヤー、敵、弾丸、スコア等）の永続化
- **連携**: `serde` で型定義、`bincode` でシリアライズ、ファイル I/O で保存
- **Engine.SaveManager**: Elixir 側から `Engine.save_session` / `Engine.load_session` で呼び出し

---

## 4. 関連ドキュメント

| ドキュメント | 用途 |
|-------------|------|
| [WHY_serde.md](./WHY_serde.md) | シリアライズ基盤 |
| [WHY_RUST.md](../WHY_RUST.md) | Rust 採用の技術的根拠 |
