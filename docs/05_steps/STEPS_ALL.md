# 実装ステップ一覧（Step 1〜47）

**目的**: 各フェーズのステップを一つのファイルにまとめ、全体像と推奨順序を把握しやすくする。  
**詳細な手順・コード例**は各フェーズの元ドキュメントを参照すること。

**ネーミング規則**: すべて「Step N: メインタイトル（補足）」の形で統一。メインタイトルは名詞・名詞句で表記。

---

## 1. 全体ロードマップ

| フェーズ | Step | 内容 |
|----------|------|------|
| **基礎** | 1〜15 | 環境構築〜ゲームオーバー・リスタートまで「動くゲーム」 |
| **クオリティ** | 16〜25 | ヒットエフェクト〜ボス・バランスで「楽しめるゲーム」 |
| **パフォーマンス** | 26〜31 | イベントバス・ETS・フリーリスト・Spatial Hash・Telemetry・SIMD |
| **汎用化** | 32〜39 | Game インターフェース・シーン汎用化・ゲーム分離・2 つ目のゲーム土台 |
| **拡張** | 40〜47 | ゲームループの Rust 移行・マップ・セーブ・マルチ・デバッグ・GameEvents リネーム・SPEC 未実装コンテンツ |

---

## 2. Step 1〜15: 基礎実装

| Step | 目標 | 備考 |
|------|------|------|
| 1 | 環境構築 | |
| 2 | ウィンドウ表示（Rust クレート・winit） | |
| 3 | wgpu 初期化・単色クリア | |
| 4 | スプライト 1 枚描画 | |
| 5 | インスタンシング描画（100 体） | |
| 6 | NIF 連携（Elixir + Rustler） | |
| 7 | ゲームループ（GenServer 60 Hz） | ※BEAM スケジューラの特性上、高精度なタイマー実行が保証されないため、Step 41 で Rust に移行 |
| 8 | プレイヤー移動 | |
| 9 | 敵スポーン・追跡 AI | |
| 10 | 衝突判定（Spatial Hash） | |
| 11 | 武器・弾丸システム | |
| 12 | 大規模スポーン・最適化（5000 体） | |
| 13 | UI（HP・スコア・タイマー） | |
| 14 | レベルアップ・武器選択 | |
| 15 | ゲームオーバー・リスタート | |

**詳細**: [STEPS_BASE.md](./STEPS_BASE.md)

---

## 3. Step 16〜25: クオリティアップ

| Step | 目標 |
|------|------|
| 16 | ヒットエフェクト（パーティクル） |
| 17 | 武器レベルアップ（重ね強化） |
| 18 | 複数敵タイプ |
| 19 | アイテムドロップ（回復・磁石） |
| 20 | カメラシステム（プレイヤー追従） |
| 21 | 武器追加（Whip / Fireball / Lightning） |
| 22 | BGM・SE（rodio） |
| 23 | スプライトアニメーション |
| 24 | ボスエネミー |
| 25 | バランス調整・ポリッシュ |

**詳細**: [STEPS_QUALITY.md](./STEPS_QUALITY.md)

---

## 4. Step 26〜31: パフォーマンス改善

| Step | 目標 | 備考 |
|------|------|------|
| 26 | イベントバス | フレームイベントを Elixir に配信 |
| 27 | ETS キャッシュ・入力ポーリング | プロセス間通信の最適化 |
| 28 | フリーリスト（スポーン O(1)） | P3 |
| 29 | Spatial Hash 最近接・RwLock | AI 高速化（P1, P2） |
| 30 | Telemetry 計測基盤 | 観測可能性（P7） |
| 31 | SIMD AI 高速化（オプション） | P4 |

**推奨順（パフォーマンス優先）**: 29 → 28 → 26 → 27 → 30 → 31  
**詳細**: [STEPS_PERF.md](./STEPS_PERF.md)  
**分析・課題整理**: [STEPS_PERFORMANCE_ANALYSIS.md](./STEPS_PERFORMANCE_ANALYSIS.md)

---

## 5. Step 32〜39: 汎用ゲームエンジン化

| Step | 目標 |
|------|------|
| 32 | Game インターフェース設計 |
| 33 | render_type 汎用化 |
| 34 | ゲーム切替（config） |
| 35 | ゲーム分離（vampire_survivor） |
| 36 | Game behaviour 実装 |
| 37 | エンジン API 安定化 |
| 38 | entity_registry（データ駆動） |
| 39 | ゲーム別アセットパス |
| 40 | 2 つ目のゲーム（ミニマル実装） |

**詳細**: [STEPS_GENERALIZATION.md](./STEPS_GENERALIZATION.md)（Step 32〜40）

---

## 6. Step 41〜47: マップ・セーブ・マルチ・デバッグ・リネーム・SPEC コンテンツ

| Step | 目標 | 備考 |
|------|------|------|
| 41 | ゲームループの Rust 移行（高精度 60 Hz） | Step 7 のゲームループを Rust 側に移行（BEAM スケジューラ上では高精度なタイマー実行が保証されないため） |
| 42 | マップ・障害物システム | |
| 43 | セーブ・ロード | |
| 44 | マルチプレイ基盤（ルーム管理） | |
| 45 | デバッグ支援（NIF） | |
| 46 | GameLoop を GameEvents にリネーム | Elixir 側の役割（frame_events 受信・フェーズ管理）に合わせてモジュール名を変更 |
| 47 | SPEC 未実装コンテンツ（Skeleton / Ghost / Garlic / 壁すり抜け） | 敵 Skeleton・Ghost、武器 Garlic、Ghost の障害物すり抜けを実装 |

**推奨順序**: 41 → 45 → 42 → 43 → 44 → 46（42 と 43 は並行可）。47 は 42 完了後が望ましい。  
**詳細**: [STEPS_EXTENSION.md](./STEPS_EXTENSION.md)

---

## 7. 依存関係（概要）

- **1〜15**: 直列（環境 → ウィンドウ → 描画 → NIF → ループ → ゲームプレイ）
- **16〜25**: 15 完了後、直列または一部並行可能
- **26〜31**: 25 完了後。29/28 を先にするとパフォーマンス効果が大きい
- **32〜40**: 31 完了後。汎用化は 32→33→34→35→36→37→38→39→40 の順が無難
- **41〜47**: 40 完了後。41 を優先すると他ステップの土台ができる。46 は 41 完了後であればいつでも実施可。47 は 42 完了後が望ましい

---

## 8. 関連ドキュメント

| ドキュメント | 用途 |
|-------------|------|
| [STEPS_BASE.md](./STEPS_BASE.md) | Step 1〜15 の詳細手順・コード |
| [STEPS_QUALITY.md](./STEPS_QUALITY.md) | Step 16〜25 の詳細手順・コード |
| [STEPS_PERF.md](./STEPS_PERF.md) | Step 26〜31 の詳細手順・コード |
| [STEPS_PERFORMANCE_ANALYSIS.md](./STEPS_PERFORMANCE_ANALYSIS.md) | パフォーマンス課題の分析・提案 |
| [STEPS_EXTENSION.md](./STEPS_EXTENSION.md) | Step 40〜47 の詳細 |
| [STEPS_GENERALIZATION.md](./STEPS_GENERALIZATION.md) | Step 32〜40 汎用化の詳細 |
| [PRIORITY_STEPS.md](../04_roadmap/PRIORITY_STEPS.md) | 実施優先度（P1〜P7, G1〜G3） |
| [SPEC.md](../01_setup/SPEC.md) | ゲーム仕様・技術仕様 |
